{"version":3,"sources":["../../scripts.babel/controllers/popup.js"],"names":[],"mappings":"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","file":"popup.js","sourcesContent":["'use strict';\n\nangular.module('TabMagicApp')\n\n.controller('PopUpCtrl', function($tabs, $windows, $sessions, $history, $scope, $q, $moment, $parse, $timeout){\n\n\t// Navigation\n\t$scope.navigation = 'recentlyClosed';\n\n\t// Show requested action button\n\t$scope.actionButtonShow = function(button){\n\n\t\t// Catcher\n\t\tvar show = false;\n\n\t\t// Recently closed\n\t\tif('recentlyClosed' === button){\n\t\t\tangular.forEach($scope.sessions.recentlyClosed.data, function(session){\n\t\t\t\tif(session.tmSelected){\n\t\t\t\t\tshow = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Recently visited\n\t\telse if('recentlyVisited' === button){\n\t\t\tangular.forEach($scope.history.recentlyVisited.data, function(item){\n\t\t\t\tif(item.tmSelected){\n\t\t\t\t\tshow = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Synces devices\n\t\telse if('devices' === button){\n\t\t\tangular.forEach($scope.sessions.devices.data, function(device){\n\t\t\t\tangular.forEach(device.sessions, function(session){\n\t\t\t\t\tangular.forEach(session.window.tabs, function(tab){\n\t\t\t\t\t\tif(tab.tmSelected){\n\t\t\t\t\t\t\tshow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t// Bring to one\n\t\telse if('bringToOne' === button || 'snooze' === button){\n\t\t\tangular.forEach($scope.windows.data, function(window){\n\t\t\t\tangular.forEach(window.tabs, function(tab){\n\t\t\t\t\tif(tab.tmSelected){\n\t\t\t\t\t\tshow = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tif($scope.tabs.current && $scope.tabs.current.tmSelected){\n\t\t\t\tshow = true;\n\t\t\t}\n\t\t}\n\n\t\treturn show;\n\n\t};\n\n\t// Sessions\n\t$scope.sessions = {\n\n\t\t// Recently closed\n\t\trecentlyClosed: {\n\n\t\t\t// Data\n\t\t\tdata: null,\n\n\t\t\t// Selected session tabs\n\t\t\tselectedTabs: [],\n\n\t\t\t// Get\n\t\t\tget: function(){\n\n\t\t\t\t// Call get recently closed from sessions service\n\t\t\t\t$sessions.getRecentlyClosed().then(function(sessions){\n\n\t\t\t\t\t// Set recently closed sessions\n\t\t\t\t\t$scope.sessions.recentlyClosed.data = sessions.filter($sessions.removeSessionsBasedOnUrl);\n\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\t// Remove selections\n\t\t\tremoveSelections: function(){\n\n\t\t\t\t// Loop through windows and set tmCollapsed to false\n\t\t\t\tangular.forEach($scope.sessions.recentlyClosed.data, function(session){\n\t\t\t\t\tsession.tmCollapsed = false;\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\t// Reopen\n\t\t\treopen: function(){\n\n\t\t\t\t// Loop through all of the recently closed sessions to find selected sessions\n\t\t\t\tangular.forEach($scope.sessions.recentlyClosed.data, function(session){\n\t\t\t\t\tif(session.tmSelected){\n\t\t\t\t\t\t$scope.sessions.recentlyClosed.selectedTabs.push(session.tab);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// If there are any selected recently open sessions\n\t\t\t\tif($scope.sessions.recentlyClosed.selectedTabs.length > 0){\n\n\t\t\t\t\t// Loop through selected session tabs\n\t\t\t\t\tangular.forEach($scope.sessions.recentlyClosed.selectedTabs, function(tab){\n\n\t\t\t\t\t\t// Call create from tab service\n\t\t\t\t\t\t$tabs.create(tab.url);\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t\t// Empty selected tabs\n\t\t\t\t$scope.sessions.recentlyClosed.selectedTabs.length = 0;\n\n\t\t\t}\n\n\t\t},\n\n\t\t// Devices\n\t\tdevices: {\n\n\t\t\t// Data\n\t\t\tdata: null,\n\n\t\t\t// Selected session tabs\n\t\t\tselectedTabs: [],\n\n\t\t\t// Get\n\t\t\tget: function(){\n\n\t\t\t\t// Call get devices from sessions service\n\t\t\t\t$sessions.getDevices().then(function(devices){\n\n\t\t\t\t\t// Set recently closed sessions\n\t\t\t\t\t$scope.sessions.devices.data = devices;\n\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\t// Open tab\n\t\t\topenTab: function(){\n\n\t\t\t\t// Loop through all of the devices to find the sessions with selected tabs\n\t\t\t\tangular.forEach($scope.sessions.devices.data, function(device){\n\t\t\t\t\tangular.forEach(device.sessions, function(session){\n\t\t\t\t\t\tangular.forEach(session.window.tabs, function(tab){\n\t\t\t\t\t\t\tif(tab.tmSelected){\n\t\t\t\t\t\t\t\t$scope.sessions.devices.selectedTabs.push(tab);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t// If there are any selected tabs\n\t\t\t\tif($scope.sessions.devices.selectedTabs.length > 0){\n\n\t\t\t\t\t// Loop through selected tabs\n\t\t\t\t\tangular.forEach($scope.sessions.devices.selectedTabs, function(tab){\n\n\t\t\t\t\t\t// Call create from tab service\n\t\t\t\t\t\t$tabs.create(tab.url);\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t\t// Empty selected tabs\n\t\t\t\t$scope.sessions.devices.selectedTabs.length = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t// Get recently closed sessions\n\t$scope.sessions.recentlyClosed.get();\n\n\t// History\n\t$scope.history = {\n\n\t\t// Recently visited\n\t\trecentlyVisited: {\n\n\t\t\t// Data\n\t\t\tdata: null,\n\n\t\t\t// Selected history items\n\t\t\tselectedHistory: [],\n\n\t\t\t// Get\n\t\t\tget: function(searchText, maxResults){\n\n\t\t\t\t// Call search history\n\t\t\t\t$history.search({ text: searchText, maxResults: maxResults }).then(function(history){\n\n\t\t\t\t\t// Set recently history\n\t\t\t\t\t$scope.history.recentlyVisited.data = history;\n\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\t// Remove selections\n\t\t\tremoveSelections: function(){\n\n\t\t\t\t// Loop through windows and set tmCollapsed to false\n\t\t\t\tangular.forEach($scope.history.recentlyVisited.data, function(item){\n\t\t\t\t\titem.tmCollapsed = false;\n\t\t\t\t});\n\n\t\t\t},\n\n\t\t\treopen: function(){\n\n\t\t\t\t// Loop through all of the recently visited webpages to find selected items\n\t\t\t\tangular.forEach($scope.history.recentlyVisited.data, function(item){\n\t\t\t\t\tif(item.tmSelected){\n\t\t\t\t\t\t$scope.history.recentlyVisited.selectedHistory.push(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// If there are any selected history items\n\t\t\t\tif($scope.history.recentlyVisited.selectedHistory.length > 0){\n\n\t\t\t\t\t// Loop through selected history items and create a new tab for each\n\t\t\t\t\tangular.forEach($scope.history.recentlyVisited.selectedHistory, function(item){\n\n\t\t\t\t\t\t// Create tab\n\t\t\t\t\t\t$tabs.create(item.url);\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t\t// Empty selected history\n\t\t\t\t$scope.history.recentlyVisited.selectedHistory.length = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t// Tabs\n\t$scope.tabs = {\n\n\t\t// Current\n\t\tcurrent: null,\n\n\t\t// One tab\n\t\toneTab: {\n\t\t\ttmOneTabSelectedTabs: [],\n\t\t\ttmOneTabCreateDate: null\n\t\t},\n\n\t\t// Query\n\t\tquery: function(active, currentWindow){\n\n\t\t\t// Call query from tabs service\n\t\t\t$tabs.query({ active: active, currentWindow: currentWindow }).then(function(tabs){\n\t\t\t\tif(tabs.length > 0){\n\t\t\t\t\t$scope.tabs.current = tabs[0];\n\t\t\t\t}\n\t\t\t});\n\n\t\t},\n\n\t\t// Bring to one tab\n\t\tbringToOne: function(sendAll){\n\n\t\t\t// Loop through all windows and tabs to find selected tabs\n\t\t\tangular.forEach($scope.windows.data, function(window){\n\t\t\t\tangular.forEach(window.tabs, function(tab){\n\n\t\t\t\t\t// Is this for all tabs?\n\t\t\t\t\tif(sendAll){ $scope.tabs.oneTab.tmOneTabSelectedTabs.push(tab); }\n\t\t\t\t\t// Not all tabs, is tab selected?\n\t\t\t\t\telse if(tab.tmSelected){ $scope.tabs.oneTab.tmOneTabSelectedTabs.push(tab); }\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// If there are any selected tabs\n\t\t\tif($scope.tabs.oneTab.tmOneTabSelectedTabs.length > 0){\n\n\t\t\t\t// Store selected tabs\n\t\t\t\t$scope.tabs.oneTab.tmOneTabCreateDate = $moment().toDate();\n\t\t\t\tchrome.storage.sync.set($scope.tabs.oneTab);\n\n\t\t\t\t// Create\n\t\t\t\t$tabs.create('one-tab.html').then(function(){\n\t\t\t\t\tconsole.log('TM: New tab created');\n\t\t\t\t}, function(){\n\t\t\t\t\tconsole.error('TM: New tab failed');\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t\t// Empty tabs.selected\n\t\t\t$scope.tabs.oneTab.tmOneTabSelectedTabs.length = 0;\n\n\t\t}\n\n\t};\n\n\t// Windows\n\t$scope.windows = {\n\n\t\t// Data\n\t\tdata: null,\n\n\t\t// Get all\n\t\tgetAll: function(){\n\n\t\t\t// Call get all from windows service\n\t\t\t$windows.getAll().then(function(windows){\n\n\t\t\t\t// Catcher\n\t\t\t\tvar windowsTemp = [];\n\n\t\t\t\t// Loop through the windows data to only grab the \"normal\" windows\n\t\t\t\tangular.forEach(windows, function(win){\n\t\t\t\t\tif('normal' === win.type){ windowsTemp.push(win); }\n\t\t\t\t});\n\n\t\t\t\t// Set windows\n\t\t\t\t$scope.windows.data = windowsTemp;\n\n\t\t\t});\n\n\t\t},\n\n\t\t// Remove selections\n\t\tremoveSelections: function(){\n\n\t\t\t// Loop through windows and set tmCollapsed to false\n\t\t\tangular.forEach($scope.windows.data, function(window){\n\t\t\t\twindow.tmCollapsed = false;\n\t\t\t});\n\n\t\t}\n\n\t};\n\n\t// Snooze\n\t$scope.snooze = {\n\n\t\t// Periodically\n\t\tperiodically: {\n\n\t\t\t// Form\n\t\t\tform: {\n\t\t\t\twakeUpThisTab: {\n\t\t\t\t\tmodel: null,\n\t\t\t\t\toptions: ['Every day', 'Every week', 'Every month', 'Every year']\n\t\t\t\t},\n\t\t\t\tatThisTime: {\n\t\t\t\t\tmodel: null\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t// Settings\n\t$scope.settings = {\n\n\t\t// Initialize\n\t\tinit: function(){\n\t\t\t$scope.settings.snooze.init();\n\t\t},\n\n\t\t// Snooze\n\t\tsnooze: {\n\n\t\t\t// Data\n\t\t\tdata: {\n\t\t\t\tworkdayStarts: {\n\t\t\t\t\tmodel: '8:00 AM',\n\t\t\t\t\toptions: ['6:00 AM', '7:00 AM', '8:00 AM', '9:00 AM', '10:00 AM', '11:00 AM'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeWorkdayStarts'\n\t\t\t\t},\n\t\t\t\tworkdayEnds: {\n\t\t\t\t\tmodel: '7:00 PM',\n\t\t\t\t\toptions: ['3:00 PM', '4:00 PM', '5:00 PM', '6:00 PM', '7:00 PM', '8:00 PM', '9:00 PM', '10:00 PM'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeWorkdayEnds'\n\t\t\t\t},\n\t\t\t\tweekStarts: {\n\t\t\t\t\tmodel: 'Monday',\n\t\t\t\t\toptions: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeWeekStarts'\n\t\t\t\t},\n\t\t\t\tweekendStarts: {\n\t\t\t\t\tmodel: 'Saturday',\n\t\t\t\t\toptions: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeWeekendStarts'\n\t\t\t\t},\n\t\t\t\tlaterToday: {\n\t\t\t\t\tmodel: 'in 3 hours',\n\t\t\t\t\toptions: ['in 1 hour', 'in 2 hours', 'in 3 hours', 'in 4 hours', 'in 5 hours'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeLaterToday'\n\t\t\t\t},\n\t\t\t\tsomeday: {\n\t\t\t\t\tmodel: 'in 3 months',\n\t\t\t\t\toptions: ['in 1 month', 'in 2 months', 'in 3 months', 'in 4 months', 'in 5 months'],\n\t\t\t\t\tstorageName: 'tmSettingsSnoozeSomeday'\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Initialize\n\t\t\tinit: function(){\n\n\t\t\t\t// Loop through all of the form data objects of snooze\n\t\t\t\tangular.forEach($scope.settings.snooze.data, function(setting){\n\n\t\t\t\t\t// Get the setting value from chrome storage\n\t\t\t\t\tchrome.storage.sync.get(setting.storageName, function(items){\n\t\t\t\t\t\tif(!angular.equals({}, items)){\n\t\t\t\t\t\t\tsetting.model = items[setting.storageName];\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Add pending and saved state to each setting\n\t\t\t\t\tsetting.saved = false;\n\t\t\t\t\tsetting.savedTimer = null;\n\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t},\n\n\t\t// Save setting change\n\t\tsave: function(model){\n\n\t\t\t// Parse requested model\n\t\t\tvar pModel = $parse(model)($scope);\n\n\t\t\t// Create object to send to storage service\n\t\t\tvar item = {};\n\t\t\titem[pModel.storageName] = pModel.model;\n\n\t\t\t// Send to service\n\t\t\tchrome.storage.sync.set(item, function(){\n\n\t\t\t\t// Set input to saved\n\t\t\t\t$timeout.cancel(pModel.savedTimer);\n\t\t\t\tpModel.saved = true;\n\t\t\t\t$scope.$apply();\n\n\t\t\t\t// Wait a bit and turn it off\n\t\t\t\tpModel.savedTimer = $timeout(function(){\n\t\t\t\t\tpModel.saved = false;\n\t\t\t\t}, 5000);\n\n\t\t\t});\n\n\t\t}\n\n\t};\n\n});\n"]}